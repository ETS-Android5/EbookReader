apply plugin: 'com.android.application'
apply plugin: 'com.jakewharton.butterknife'

android {
    compileSdkVersion rootProject.ext.compileSdkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion

    defaultConfig {
        applicationId "com.longluo.ebookreader"

        minSdkVersion rootProject.ext.appMinSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion

        versionCode rootProject.ext.versionCode
        versionName rootProject.ext.versionName

        ndk {
            moduleName "DeflatingDecompressor-v3"
        }
    }
    
//    buildFeatures {
//        viewBinding true
//    }
    
    buildTypes {
        release {
            if (project.hasProperty("RELEASE_STORE_FILE")) {
                signingConfig signingConfigs.myConfig
            }
            applicationIdSuffix '.release'
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }

        debug {
            if (project.hasProperty("RELEASE_STORE_FILE")) {
                signingConfig signingConfigs.myConfig
            }
            applicationIdSuffix '.debug'
            versionNameSuffix 'debug'
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }

        android.applicationVariants.all { variant ->
            variant.outputs.all {
                def flavor = variant.productFlavors[0].name
                outputFileName = "${name}_${flavor}_${defaultConfig.versionName}.apk"
            }
        }
	
	sourceSets {
            main {
                jni.srcDirs = []
            }
        }
    }

    flavorDimensions "mode"

    productFlavors {
        app {
            dimension "mode"
            manifestPlaceholders = [APP_CHANNEL_VALUE: "app"]
        }

        google {
            dimension "mode"
            applicationId "com.longluo.play"
            manifestPlaceholders = [APP_CHANNEL_VALUE: "google"]
        }

        cronet {
            dimension "mode"
            applicationId "com.longluo.cronet"
            manifestPlaceholders = [APP_CHANNEL_VALUE: "cronet"]
            ndk {
                abiFilters 'arm64-v8a','armeabi-v7a','x86_64','x86'
            }
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

//    kotlinOptions {
//        jvmTarget = "1.8"
//    }

    tasks.withType(JavaCompile) {
        //options.compilerArgs << "-Xlint:unchecked"
    }
    
    packagingOptions {
        exclude 'META-INF/DEPENDENCIES'
        exclude 'META-INF/NOTICE'
        exclude 'META-INF/LICENSE'
        exclude 'META-INF/LICENSE.txt'
        exclude 'META-INF/NOTICE.txt'
    }
}

dependencies {
    implementation project(':AmbilWarna')
    implementation project(':android-filechooser')
    implementation project(':SuperToasts')

    implementation files('libs/LingvoIntegration_2.5.2.12.jar')
    implementation files('libs/json-simple-1.1.1.jar')
    implementation files('libs/nanohttpd-2.0.5.jar')
    implementation files('libs/open-dictionary-api-1.2.1.jar')
    implementation files('libs/pdfparse.jar')
    
    implementation "androidx.legacy:legacy-support-v4:1.0.0"
    implementation 'org.apache.httpcomponents:httpmime:4.5.12'

    // Butter Knife
    implementation 'com.jakewharton:butterknife:10.2.1'
    annotationProcessor 'com.jakewharton:butterknife-compiler:10.2.1'

}